## 概要

一次合同式 $ax \equiv c \pmod m$ の解をすべて求める．
解が存在する必要十分条件は，$\gcd(a,m) \mid c$ であること．


### アルゴリズムの説明

整数 $x$ で $ax - c$ が $m$ で割り切れるようなものを探す．
言い換えると，$ax - c = my$ である整数 $y$ を見つけられれば良い．
つまり，解 $x$ が存在する必要十分条件は，一次方程式 $ax - my = c$ が解をもつことだとわかる．

拡張ユークリッドの互除法により，一次方程式 $ax - my = c$ を解く．

まず，$g = \gcd(a,m)$ とおくと $ax - my$ の形をした数は $g$ の倍数であるので，$c$ が $g$ で割り切れなければ $ax - my = c$ は解をもたず，$ax \equiv c \pmod m$ も解をもたない．
以降，$g$ が $c$ を割り切るものとする．

拡張ユークリッドの互除法から，方程式 $au + mv = g$ はいつでもある整数解 $(u_0,v_0)$ をもつ．
そのとき，方程式の両辺に $c/g$ をかけると

$$
a \frac{c u_0}{g} + m \frac{c v_0}{g} = c
$$

となる．
これより

$$
a \frac{c u_0}{g} \equiv c \pmod m
$$

であるから，$c u_0 / g \bmod m$ が合同式 $ax \equiv c \pmod m$ の解となる．
これを $x_0$ とおく．

次に $x_1$ を別の解とする．
このとき $a x_0 \equiv a x_1 \pmod m$ であるので，$m$ は $a x_1 - a x_0$ を割り切る．
つまり $m/g$ は $a (x_1 - x_0) / g$ を割り切る．
ここで $m/g$ と $a/g$ は共通因子をもたないので，$m/g$ は $x_1 - x_0$ を割り切れる必要がある．

つまり，適当な整数 $k$ を用いて

$$
x_1 = x_0 + k \cdot \frac{m}{g}
$$

と表せる．
$m$ を法とするとき $m$ の倍数だけ異なるどの2解も同一の解とみなすので，ちょうど $g$ 個の相異なる解を得る．

よって，以下のことがいえる．

- $g \nmid c$ のとき，合同式 $ax \equiv c \pmod m$ は解をもたない．
- $g \mid c$ のとき，合同式 $ax \equiv c \pmod m$ のすべての解は $$\begin{align} &x_0 \equiv \frac{c u_0}{g} \pmod m , \notag\\ &x \equiv x_0 + k \cdot \frac{m}{g} \pmod m \ (k = 0, 1, \ldots, g-1) \notag \end{align} $$ で与えられる．


## 参考文献

1. H.H. シルヴァーマン. "第8章 余りを調べる —— 合同式". はじめての数論. 鈴木治郎訳. 原著第4版, 丸善出版, 2022, p.54-61.
